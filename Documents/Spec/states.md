# シーン状態遷移

[目次へ](./spec_contents.md)

Unityのシーンを切り替えるためのシーン状態管理システム(`SceneStateChanger`)。これとは別に、汎用で使える状態スタック(`AM1StateStack`)と優先度付き状態キュー(`AM1StackQueue`)を`AM1State`パッケージで提供している。

## 切り替え方
　状態の切り替え処理はIStateChangerインターフェースを実装したスクリプトに実装する。切り替える時は、該当する状態切り替えスクリプトのRequest()を呼ぶ。

## 起動
- BootStateChanger
  - 画面を覆う
  - 保存処理の登録と初期化、読み込み
  - タイトル起動

## タイトル
- 画面を表示
- スタートボタンでゲーム開始
- スライダーでボリューム調整

## ゲーム
- プレイヤーを停止状態
- プレイヤー操作
- 落下したらMISS...と表示して結果画面へ。MissStateChanger開始
- ゴールについたらSUCCESS!!と表示して結果画面へ。SuccessStateChanger開始

## 結果画面
- 指定の文字をカットイン
- クリックしたらタイトルヘ

## テスト
　起動からタイトル、ゲーム開始、成功、タイトル、ゲーム開始、ミス、タイトルの切り替わりを実行するテストを作成する。

1. Systemシーンを起動
1. 起動が完了するか、指定フレームが経過するのを待つ
1. 指定フレーム内での起動完了を確認
1. Titleシーンが起動したかを確認
1. Titleシーンの開始を待つ
1. ゲーム開始
1. シーン切り替え待ち
1. ゲームへの切り替え完了テスト
1. クリア開始
1. シーン切り替え待ち
1. クリアへの切り替え完了テスト
1. タイトルヘ
1. シーン切り替え待ち
1. タイトルへの切り替え完了テスト
1. ゲーム開始
1. シーン切り替え待ち
1. ゲームへの切り替え完了テスト
1. ミス開始
1. シーン切り替え待ち
1. ミスへの切り替え完了テスト
1. タイトルヘ
1. シーン切り替え待ち
1. タイトルへの切り替え完了テスト
1. ゲーム開始
1. シーン切り替え待ち
1. ゲームへの切り替え完了テスト

### テストに必要な機能
- 起動が完了するか、指定フレームが経過するのを待つ処理
- シーンのAwakeが完了したことを確認するフラグ。IStateChangerにプロパティで実装
- 起動したシーンを確認 SceneChanger.IsScene()でインスタンスを確認


[目次へ](./spec_contents.md)
