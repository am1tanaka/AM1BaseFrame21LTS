# AM1BaseFrame21LTS
Unity2021LTS向けにまとめた自家製フレームワークです。1週間ゲームジャムなどでの利用や設計の勉強を目的として開発しています。

そのまま使っていただいても構いませんし、改造や反面教師とするなどご自由にご利用ください。

## 対応バージョン
- Unity2020LTS以降

## 機能
以下の機能を提供します。

- 状態の定義と切り替え
- 状態の切り替えと画面を覆う演出の連携
- 画面を覆う演出サンプルとしてフェードと扇形塗りつぶし
- BGMとシステム効果音の再生
- BGMと効果音のボリュームスライダー
- PlayerPrefsへのボリューム設定の保存と読み込み
- 新しい状態やシーンを作成するエディター拡張

## インポート手順
以下、フレームワークのインポート手順です。Unity2021.3.10f1での手順を示しています。別バージョンの場合は手順が異なるかも知れません。

1. フレームワークを組み込みたいUnityプロジェクトを開きます
1. WindowメニューからPackage Managerを開きます
1. + をクリックして Add package from git URL... を選択します

![Add package from git URL...](./Documents/Images/readme00.png)

1. `` を入力して、Addをクリックします

以上でインポートが始まります。

## 最初の設定
必要なアセットをインポートします。

1. Toolsメニューから AM1 > Import BaseFrame Assets を選択します
1. 起動スクリプトを保存するフォルダーを選択します。起動スクリプトから開発プロジェクトへアクセスできるように、フレームワークではなく開発プロジェクトのスクリプトフォルダーを選択してください

インポートが完了したら、状態を管理するシステムシーンを作成します。

1. システム用のシーンを作成するか、開きます
1. Toolsメニューから、AM1 > Set StateSystem to ActiveScene を選択します
1. 必要なアセットをインポートする時に指定したスクリプト用フォルダーから、Booterスクリプトをドラッグして、シーンに作成された Booter オブジェクトにアタッチします

以上で初期設定が完了します。起動すると画面が真っ白になります。これは起動に備えて画面を覆う処理を実行したままになっているからです。最初の状態とシーンを作成して切り替えることで処理を開始できます。

## 本システムの考え方
本システムは、状態やBGM再生を管理するシステムシーンを最初に起動したままにしておいて、タイトルやゲームなどの状態にあわせたシーンをマルチシーンで開いて状態を切り替える仕組みです。スコアやプレイヤー情報などのアプリ全体で利用する情報やUIは、システムシーンで管理すると便利です。

先に作成した`Booter`や起動時の処理を実行する`BootStateChanger`には、起動時に一度だけ実行したい処理を実装します。例えばBGMや効果音のボリュームの設定はBootStateChangerで読み込んでいます。BootStateChangerの最後で、起動したい状態へのリクエストを出すことでアプリを開始します。先に実行していた状態を保存しておいて、アプリを再起動する時に保存した状態を読み込んで該当状態から再開すれば、スマホの中断からの復帰が便利になります。

状態とシーンを管理するためのスクリプトや最小限のオブジェクトが必要になります。新しい状態やシーンを作成する場合は、Tools/AM1メニューを利用します。

## 最初の状態とシーンを作成する
執筆中



## サンプル
超ミニゲーム。

- Package ManagerのSampleをインストールします
- WindowメニューからTextMeshPro > Import TMP Essential Resources と Import TMP Examples and Extras をインストールします
- 2D Tilemap Editorをインストールします
- Toolsメニューから、AM1 > Set Demo Tags and Layersを選択して、デモで利用しているタグとレイヤーを読み込みます

以上で実行できます。Gameビューのレイアウトは16:9、あるいは、960x540で実行すると想定したレイアウトになります。

## ライセンス

### 本体パッケージ
MITライセンス

### デモ使用アセット
以下、いずれもCC0。

- キャラクター、マップチップ、背景
  - [www.kenney.nl Platformer Assets Base](www.kenney.nl)
- BGM
  - [www.kenney.nl Music Loops/Retro](www.kenney.nl)
- 効果音
  - [www.kenney.nl Interface Sounds](www.kenney.nl)
