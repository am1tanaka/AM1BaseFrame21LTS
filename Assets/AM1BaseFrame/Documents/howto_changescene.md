# シーンの切り替え

練習用の新規プロジェクトを作って、起動からシーンの切り替えを実装してみましょう。
以下の簡易なゲームループを実装します。

- 起動(Boot)
  - 画面を隠す処理とボリュームシステムの初期化
  - 自動的にタイトルシーンへ切り替え
  - 切り替えはFilledRadial
- タイトルシーン(Title)
  - クリックしたら仮のゲームシーンへ
  - 切り替えはFilledRadial
- ゲームシーン(Game)
  - クリックしたらゲームオーバーシーンへ
- ゲームオーバーシーン(Gameover)
  - ゲームシーンにゲームオーバーシーンをマルチシーンで表示
  - クリックしたらタイトルへ戻る
  - 切り替えはFade

## 準備

新規にプロジェクトを作成して最初の設定をします。

1. Unity Hubを起動
1. Unity2021.3.Xで新規プロジェクトを作成。テンプレートは何でも構いません
1. プロジェクトフォルダー内の`Packages/manifest.json`をテキストエディターなどで開きます
   - Visual Studioなら以下の操作で開きます
     - ProjectビューのAssetsを右クリックして Open C# Project を選択
     - ソリューションエクスプローラーのホームの隣の ソリューションと利用可能なビューとの切り替え をクリックして フォルダービュー にします
     - `Packages/manifest.json`を開きます
1. dependenciesの最初に以下を追加します

```
    "jp.am1.baseframe": "https://github.com/am1tanaka/AM1BaseFrame21LTS.git?path=/Assets/AM1BaseFrame",
    "jp.am1.utils": "https://github.com/am1tanaka/AM1BaseFrame21LTS.git?path=/Assets/AM1Utils",
```

上書き保存してUnityに切り替えたら自動的にインストールが始まります。

パッケージのインストールが完了したら、プロジェクトで利用するアセットをインポートします。

1. ProjectウィンドウでAssetsフォルダーの下に新規フォルダーを作成して`Scripts`という名前にします
1. Toolsメニューから AM1 > Import BaseFrame Assets を選択します
1. 先に作成した`Scripts`フォルダーを選択します
1. インポートダイアログが表示されたらImportボタンをクリックします

途中でエラーが表示されてもインポートが完了したら消えるので気にせず進めてください。

以上でプロジェクトに必要なものの追加は完了です。


## シーンの作成

### システム用シーンの作成
必要なシーンを作成します。まずはシステム用のシーンを作ります。

1. SampleSceneシーンの名前を`System`に変更して、システム用のシーンとして使います
1. Toolsメニューから、AM1 > Set StateSystem to Active Scene を選択して、追加 をクリックします
1. Systemシーン用のオブジェクトの生成ダイアログが表示されたら追加をクリックします
1. TextMeshProのダイアログが表示されたらImport TMP Essentialsをクリックします
1. インポートが完了したらダイアログを閉じます
1. HierarchyウィンドウからBooterオブジェクトをクリックして選択します
1. InspectorウィンドウのAdd ComponentからBooterスクリプトをアタッチします

以上でシステムシーンの設定ができました。Playして画面が真っ白になれば成功です。これは起動に備えて画面を覆う処理を実行したままになっているからです。最初の状態とシーンを作成して切り替えることで処理を開始できます。

このシーンを最初に起動するようにします。他のシーンはマルチシーンで読み込んで、このシーンは破棄しません。常駐させたいオブジェクトやスクリプトを配置するためのシーンとしてSystemシーンを利用してください。

### 各状態シーンの作成

タイトル、ゲーム、ゲームオーバー用のシーンを作成します。
動作確認が目的なので、TextMeshProでシーン名を表示しただけの簡単なシーンにします。

